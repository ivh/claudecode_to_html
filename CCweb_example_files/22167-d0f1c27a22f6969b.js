try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e1c53838-505b-47b9-aeca-0803ae5a94fe",e._sentryDebugIdIdentifier="sentry-dbid-e1c53838-505b-47b9-aeca-0803ae5a94fe")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[22167],{0x1381f2bb:(e,t,o)=>{o.d(t,{O:()=>a});var r=o(0x22102fd88),n=o(0x1a1f6dda6);let a=e=>{let{size:t=20,borderRadius:o=.27*t,className:a,children:s}=e;return(0,r.jsx)("div",{style:{width:t,height:t,borderRadius:o},className:(0,n.A)("shrink-0 bg-bg-000 border-border-300 border-0.5 shadow-sm flex items-center justify-center",a),children:s})}},0x4d9fc74e:(e,t,o)=>{o.d(t,{Q:()=>i});var r=o(0xf32c56dd),n=o(0x14de19ae8),a=o(0x1bd175d8c),s=o(0x4d348f95),c=o(0x21fe74567);let i=function(){let{pathname:e,queryString:t="",source:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:i}=(0,n.YL)(),l=(0,s.usePathname)(),u=(0,s.useSearchParams)(),d=(0,a.V)(),{track:m}=(0,r.st)(),p="".concat((0,c.d)({pathname:e||l,searchParams:u,queryString:t,shouldOpenInClaudeApp:d}));return e=>{let{uuid:t,url:r}=e;m({event_key:"claudeai.mcp.auth.init",uuid:t,url:r,source:o}),window.location.href="/api/organizations/".concat(null==i?void 0:i.uuid,"/mcp/start-auth/").concat(t,"?redirect_url=").concat(encodeURIComponent(p),"&open_in_browser=1")}}},0x6f6d4bd7:(e,t,o)=>{o.d(t,{U2:()=>d,UT:()=>u,_c:()=>p,qO:()=>l});var r=o(0x18e5c6e75),n=o(0x253a5c787),a=o(0x15b8dbfeb),s=o.n(a),c=o(0x156c4e43b);let i=e=>e.replace(/_/g," ").replace(/^\w/,e=>e.toUpperCase());async function l(e,t,o){try{return(await t.listTools({},{timeout:5e3})).tools.map(e=>o?(0,r.M)(e):e).map(t=>{var o,r,n;return{...t,displayName:i(t.title||(null==(o=t.annotations)?void 0:o.title)||t.name),enabledKey:(r=e,n=t.name,"".concat(r,":").concat(n)),alwaysApprovedKey:""}}).map(e=>({...e,alwaysApprovedKey:function(e){let t=e.enabledKey,o=e.description||"",r=function(e){var t;let o=Object.entries((null==(t=e.inputSchema)?void 0:t.properties)||{}),r=[];for(let[e,t]of o){let{data:o}=m.safeParse(t),n=(null==o?void 0:o.description)||"";r.push([e,n])}return r.sort((e,t)=>e[0].localeCompare(t[0])).flat().join(",")}(e),n=s().createHash("md5").update("".concat(o,":").concat(r)).digest("hex");return"".concat(t,"-").concat(n)}(e)}))}catch(t){return(0,n.Cp)(t,{tags:{action:"listTools",serverUuid:e}}),[]}}async function u(e,t){try{var o;if(!(null==(o=t.getServerCapabilities())?void 0:o.prompts))return[];return(await t.listPrompts({},{timeout:5e3})).prompts.map(e=>({...e,displayName:i(e.title||e.name)}))}catch(t){return(0,n.Cp)(t,{tags:{action:"listPrompts",serverUuid:e}}),[]}}async function d(e,t){try{var o;if(!(null==(o=t.getServerCapabilities())?void 0:o.resources))return[];return(await t.listResources({},{timeout:5e3})).resources.map(e=>({...e,displayName:i(e.title||e.name)}))}catch(t){return(0,n.Cp)(t,{tags:{action:"listResources",serverUuid:e}}),[]}}let m=c.Ik({description:c.Yj().optional(),type:c.Yj().optional(),title:c.Yj().optional()}).optional();function p(e,t){if(e.url){var o;return e.url.replace(/\/$/,"")===(null!=(o=null==t?void 0:t.replace(/\/$/,""))?o:"")}if(e.urlRegex){let o=new RegExp(e.urlRegex);return!!t&&o.test(t)}return!1}},0x8475f78a:(e,t,o)=>{o.d(t,{Ds:()=>i,Ic:()=>a,RK:()=>s});var r=o(0xac309a83),n=o(0x156c4e43b);let a=e=>"".concat(e,"-wrapped"),s=n.Ik({isConnected:n.zM(),expiration:n.ai()});function c(e,t){var o;if(!(null==(o=(0,r.Je)())?void 0:o.checkGate("claudeai_mcp_local_cache")))return;let n=Date.now(),a={};try{let e=localStorage.getItem("mcp-remote-connectors-state"),t=e?JSON.parse(e):{};if("object"==typeof t&&null!==t)for(let[e,o]of Object.entries(t)){let t=s.safeParse(o);t.success&&t.data.expiration>n&&(a[e]=t.data)}}catch(e){}try{a[e]={isConnected:t,expiration:n+864e5},localStorage.setItem("mcp-remote-connectors-state",JSON.stringify(a))}catch(e){}}let i=e=>({remoteServers:{},remoteConnectionStates:{},remoteClients:{},remoteTools:{},remotePrompts:{},remoteResources:{},remoteDirectories:{},remoteIsLoading:!1,addRemoteServer:t=>e(e=>({remoteServers:{...e.remoteServers,[t.uuid]:t},remoteConnectionStates:{...e.remoteConnectionStates,[t.uuid]:{isConnected:!1,isConnecting:!0,usedAuthentication:!1}}})),setRemoteServerConnected:(t,o)=>e(e=>(c(t,!0),{...e,remoteConnectionStates:{...e.remoteConnectionStates,[t]:{isConnected:!0,isConnecting:!1,usedAuthentication:o}}})),setRemoteClient:(t,o)=>e(e=>({remoteClients:{...e.remoteClients,[t]:o}})),disconnectRemoteServer:t=>e(e=>{let{[t]:o,[a(t)]:r,...n}=e.remoteClients;c(t,!1);let{[t]:s,...i}=e.remoteTools,{[t]:l,...u}=e.remotePrompts,{[t]:d,...m}=e.remoteResources;return{...e,remoteConnectionStates:{...e.remoteConnectionStates,[t]:{isConnected:!1,isConnecting:!1,usedAuthentication:!1}},remoteClients:n,remoteTools:i,remotePrompts:u,remoteResources:m}}),removeRemoteServer:t=>e(e=>{let{[t]:o,...r}=e.remoteServers,{[t]:n,...s}=e.remoteConnectionStates,{[t]:c,[a(t)]:i,...l}=e.remoteClients,{[t]:u,...d}=e.remoteTools,{[t]:m,...p}=e.remotePrompts,{[t]:f,...g}=e.remoteResources,{[t]:v,...h}=e.remoteDirectories;return{...e,remoteServers:r,remoteConnectionStates:s,remoteClients:l,remoteTools:d,remotePrompts:p,remoteResources:g,remoteDirectories:h}}),setRemoteTools:(t,o)=>e(e=>({remoteTools:{...e.remoteTools,[t]:o}})),setRemotePrompts:(t,o)=>e(e=>({remotePrompts:{...e.remotePrompts,[t]:o}})),setRemoteResources:(t,o)=>e(e=>({remoteResources:{...e.remoteResources,[t]:o}})),setRemoteDirectory:(t,o)=>e(e=>({remoteDirectories:o?{...e.remoteDirectories,[t]:o}:e.remoteDirectories})),setRemoteIsLoading:t=>e({remoteIsLoading:t})})},0xe824fb1c:(e,t,o)=>{o.d(t,{rD:()=>y,nd:()=>f,s$:()=>g,eZ:()=>d,Ug:()=>b,pK:()=>V,KU:()=>N,_b:()=>F,OT:()=>h,dY:()=>L,et:()=>m,xk:()=>p,H:()=>D,eg:()=>_,jh:()=>A,yt:()=>E,kU:()=>P,BG:()=>k,zC:()=>O,fR:()=>j,kc:()=>x,I3:()=>T,pZ:()=>C,k$:()=>w,aF:()=>I,n3:()=>S,MR:()=>R,HG:()=>v,qT:()=>q,Ak:()=>K,Uz:()=>U,Q1:()=>z});var r=o(0x247a15645),n=o(0xfc89b4a4),a=o(0x394ef833),s=o(0x16784b660),c=o(0x107838ca5),i=o(0x1c9feff0c),l=o(0x8475f78a),u=o(0x6f6d4bd7);let d=(0,a.v)()((0,s.eh)(function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return{...(e=>({localClients:{},localTools:{},localPrompts:{},localResources:{},dxts:{},localIsLoading:!1,setLocalClient:(t,o,r)=>e(e=>({localClients:{...e.localClients,[t]:{uuid:null!=r?r:t,client:o}}})),removeLocalServer:t=>e(e=>{let{[t]:o,...r}=e.localClients,{[t]:n,...a}=e.localTools,{[t]:s,...c}=e.localPrompts,{[t]:i,...l}=e.localResources,{[t]:u,...d}=e.dxts;return{localClients:r,localTools:a,localPrompts:c,localResources:l,dxts:d}}),setLocalTools:(t,o)=>e(e=>({localTools:{...e.localTools,[t]:o}})),setLocalPrompts:(t,o)=>e(e=>({localPrompts:{...e.localPrompts,[t]:o}})),setLocalResources:(t,o)=>e(e=>({localResources:{...e.localResources,[t]:o}})),setDxt:(t,o)=>e(e=>({dxts:{...e.dxts,[t]:o}})),setLocalIsLoading:t=>e({localIsLoading:t})}))(...t),...(0,l.Ds)(...t)}})),m=e=>d.getState().remoteServers[e],p=async e=>d.getState().remoteClients[(0,l.Ic)(e)],f=e=>void 0===d.getState().remoteServers[e],g=e=>void 0===d.getState().remoteConnectionStates[e],v=(e,t)=>{let o=d.getState();return!t||(0,l.Ic)(e)in o.remoteClients},h=e=>{let t=d.getState();for(let[l,u]of Object.entries(t.remoteServers)){let d=t.remoteDirectories[l];if((null==d?void 0:d.uuid)===e){var o,r,n,a,s,c,i;let e=t.remoteConnectionStates[l];return{name:u.name,uuid:u.uuid,type:"remote",url:u.url,custom_oauth_client_id:u.custom_oauth_client_id,custom_oauth_client_secret:u.custom_oauth_client_secret,iconType:"favicon",iconSrc:null!=(o=null==d?void 0:d.iconUrl)?o:u.url,isConnected:null!=(r=null==e?void 0:e.isConnected)&&r,isConnecting:null!=(n=null==e?void 0:e.isConnecting)&&n,usedAuthentication:null!=(a=null==e?void 0:e.usedAuthentication)&&a,tools:null!=(s=t.remoteTools[l])?s:[],prompts:null!=(c=t.remotePrompts[l])?c:[],resources:null!=(i=t.remoteResources[l])?i:[],directoryMetadata:d}}}},y=e=>d.getState().addRemoteServer(e),S=(e,t)=>d.getState().setRemoteServerConnected(e,t),b=e=>d.getState().disconnectRemoteServer(e),_=e=>d.getState().removeRemoteServer(e),x=(e,t)=>d.getState().setRemoteClient(e,t),C=e=>d.getState().setRemoteIsLoading(e),R=async(e,t,o)=>{let r=await (0,u.qO)(e,t,o);return d.getState().setRemoteTools(e,r),r},w=async(e,t)=>{let o=await (0,u.UT)(e,t);return d.getState().setRemotePrompts(e,o),o},I=async(e,t)=>{let o=await (0,u.U2)(e,t);return d.getState().setRemoteResources(e,o),o},T=(e,t,o)=>{d.getState().setRemoteDirectory(e,o.find(e=>(0,u._c)(e,t)))},L=e=>{for(let[,{uuid:t,client:o}]of Object.entries(d.getState().localClients))if(t===e)return o},A=(e,t,o)=>d.getState().setLocalClient(e,t,o),P=e=>d.getState().setLocalIsLoading(e),D=e=>d.getState().removeLocalServer(e),E=(e,t)=>d.getState().setDxt(e,t),G=e=>"local:".concat(e),j=async(e,t,o)=>{let r=await (0,u.qO)(G(e),t,o);return d.getState().setLocalTools(e,r),r},k=async(e,t)=>{let o=await (0,u.UT)(G(e),t);return d.getState().setLocalPrompts(e,o),o},O=async(e,t)=>{let o=await (0,u.U2)(G(e),t);return d.getState().setLocalResources(e,o),o};function M(e,t){for(let[i,l]of Object.entries(t)){var o,r,n,a,s,c;if(void 0!==l){if("hasTools"===i){if(((null==(o=e.tools)?void 0:o.length)||0)>0!==l)return!1}else if("hasPrompts"===i){if(((null==(r=e.prompts)?void 0:r.length)||0)>0!==l)return!1}else if("hasResources"===i){if(((null==(n=e.resources)?void 0:n.length)||0)>0!==l)return!1}else if("hasPromptsOrResources"===i){let t=((null==(a=e.prompts)?void 0:a.length)||0)>0,o=((null==(s=e.resources)?void 0:s.length)||0)>0;if((t||o)!==l)return!1}else if("directoryUuid"===i){if((null==(c=e.directoryMetadata)?void 0:c.uuid)!==l)return!1}else if(e[i]!==l)return!1}}return!0}let U=e=>{let t=d((0,c.k)(e=>({remoteServers:e.remoteServers,remoteConnectionStates:e.remoteConnectionStates,remoteTools:e.remoteTools,remotePrompts:e.remotePrompts,remoteResources:e.remoteResources,remoteDirectories:e.remoteDirectories,localClients:e.localClients,localTools:e.localTools,localPrompts:e.localPrompts,localResources:e.localResources,dxts:e.dxts})));return(0,n.useMemo)(()=>{var o,r,n,a,s,c,l;let u=[];for(let[s,c]of Object.entries(t.remoteServers)){if(!c)continue;let i=t.remoteDirectories[s],l={...c,uuid:s,type:"remote",iconType:"favicon",iconSrc:null!=(o=null==i?void 0:i.iconUrl)?o:c.url,directoryMetadata:i,...t.remoteConnectionStates[s],tools:null!=(r=t.remoteTools[s])?r:[],prompts:null!=(n=t.remotePrompts[s])?n:[],resources:null!=(a=t.remoteResources[s])?a:[],version:void 0};(!e||M(l,e))&&u.push(l)}u.sort((e,t)=>e.name.localeCompare(t.name));let d=[];for(let[o,r]of Object.entries(t.localClients)){if(!r)continue;let n=t.dxts[o],a={name:o,uuid:r.uuid,type:"local",iconType:"external",iconSrc:(null==n?void 0:n.manifest.icon)?(0,i.C)(n.manifest.icon,n.path):void 0,isConnected:!0,isConnecting:!1,usedAuthentication:!1,tools:null!=(s=t.localTools[o])?s:[],prompts:null!=(c=t.localPrompts[o])?c:[],resources:null!=(l=t.localResources[o])?l:[],localId:null==n?void 0:n.id};(!e||M(a,e))&&d.push(a)}return d.sort((e,t)=>e.name.localeCompare(t.name)),[...u,...d]},[t,e])},z=()=>d(e=>e.remoteIsLoading||e.localIsLoading),K=()=>{let e=d(e=>e.remoteClients),t=d(e=>e.remoteServers),o=d(e=>e.localClients),a=d(e=>e.dxts);return(0,n.useMemo)(()=>{let n=[],s=new Map;return Object.entries(e).forEach(e=>{let[o,a]=e;if(a instanceof r.K){var c;n.push(a);let e=t[o];s.set(a,{name:null!=(c=null==e?void 0:e.name)?c:o,iconType:"favicon",iconSrc:null==e?void 0:e.url})}}),Object.entries(o).forEach(e=>{let[t,o]=e;n.push(o.client);let r=a[t];s.set(o.client,{name:t,iconType:"external",iconSrc:(null==r?void 0:r.manifest.icon)?(0,i.C)(r.manifest.icon,r.path):void 0})}),{clients:n,clientMetadata:s}},[e,t,o,a])},N=e=>{let t=L(e)||d.getState().remoteClients[e];if(!t)throw Error("Client not found for connector ".concat(e));if(t instanceof Promise)throw Error("Client for connector ".concat(e," is still connecting"));return t},V=e=>{let t=d.getState();for(let[n,a]of Object.entries(t.remoteServers)){var o,r;let s=null!=(r=null==(o=t.remoteTools[n])?void 0:o.find(t=>"".concat(a.name,":").concat(t.name)===e))?r:void 0;if(s)return{tool:s,server:{uuid:n,name:a.name,url:a.url,type:"remote",iconType:"favicon",iconSrc:a.url}}}for(let[o,r]of Object.entries(t.localTools)){let n=r.find(t=>"".concat(o,":").concat(t.name)===e),a=t.localClients[o],s=t.dxts[o],c=(null==s?void 0:s.manifest.icon)?(0,i.C)(s.manifest.icon,s.path):void 0;if(n&&a)return{tool:n,server:{uuid:a.uuid,name:o,type:"local",iconType:"external",iconSrc:c}}}},q=e=>Object.values(d.getState().remoteTools).flat().find(t=>t.name===e)||Object.values(d.getState().localTools).flat().find(t=>t.name===e),F=(e,t,o)=>{let r=d.getState(),n=[];for(let[a,s]of Object.entries(r.remoteTools)){let c=r.remoteServers[a];c&&s.filter(e=>(null==t?void 0:t[e.enabledKey])!==!1).forEach(t=>{var r;let s;o&&(s=o(c,t).approvalRequired),n.push({name:t.name,description:null!=(r=t.description)?r:t.name,input_schema:t.inputSchema,integration_name:c.name,mcp_server_uuid:c.uuid,mcp_server_url:c.url,needs_approval:s,backend_execution:!v(a,e)})})}for(let[e,o]of Object.entries(r.localTools))o.filter(e=>(null==t?void 0:t[e.enabledKey])!==!1).forEach(t=>{var o;n.push({name:t.name,description:null!=(o=t.description)?o:t.name,input_schema:t.inputSchema,integration_name:e})});return n}},0xf8bd7957:(e,t,o)=>{o.d(t,{z:()=>u});var r=o(0x22102fd88),n=o(0x1381f2bb),a=o(0x303b360c),s=o(0x1fec22234),c=o(0x1d0c32e96),i=o(0x246499564),l=o(0x1a1f6dda6);let u=e=>{let{size:t,imageSize:o,name:u="",className:d,fallbackToGlobe:m,type:p,src:f}=e,g=!o,v=null!=o?o:t,h=m?void 0:(0,r.jsx)(a.B,{letter:u,size:v,hideBorder:!g}),y=e=>(0,r.jsx)(n.O,{size:t,className:(0,l.A)(d,g&&"!border-0 !shadow-none !bg-transparent"),children:e});switch(p){case"favicon":return y((0,r.jsx)(s.d,{fadeInOnLoad:!0,url:f,size:v,fallbackSvg:h}));case"external":return y((0,r.jsx)(i.u,{style:{maxWidth:v,maxHeight:v},className:"object-contain",width:v,height:v,src:f||"",alt:"".concat(u," icon"),fallbackSvg:h,fadeInOnLoad:!0}));case"syncSource":return y((0,r.jsx)(c.A9,{type:f,size:v}));case"icon":return y((0,r.jsx)(i.o,{style:{maxWidth:v,maxHeight:v},className:"object-contain",width:v,height:v,src:f||"",alt:"".concat(u," icon"),fallbackSvg:h,fadeInOnLoad:!0}));default:return y(h)}}},0x18175ce17:(e,t,o)=>{o.d(t,{Cg:()=>U,Dd:()=>T,FZ:()=>w,LN:()=>x,TI:()=>D,X0:()=>K,Ys:()=>O,dJ:()=>G,eL:()=>L,fe:()=>N,hm:()=>P,kO:()=>k,ob:()=>z,ph:()=>R,qi:()=>E,tS:()=>_,vm:()=>j,xc:()=>C,z3:()=>I});var r=o(0x17aa9d8d7),n=o(0x12c9046cd),a=o(0x14de19ae8),s=o(0x139b5e710),c=o(0x1016c6ed2),i=o(0x49fac030),l=o(0xac309a83),u=o(0x1b813d90),d=o(0x1bd175d8c),m=o(0x78b33fbd),p=o(0x17e725145),f=o(0x4d348f95),g=o(0xfc89b4a4),v=o(0x1ab0d1ca1),h=o(0x21fe74567),y=o(0x4d9fc74e),S=o(0xe824fb1c),b=o(0xc6857cab);let _=e=>e.type===u.v8.GITHUB?{sync_source_type:u.v8.GITHUB,sync_source_config:e.config}:e.type===u.v8.GDRIVE?{sync_source_type:u.v8.GDRIVE,sync_source_config:e.config}:null,x=()=>{let{activeOrganization:e}=(0,a.YL)(),t=null==e?void 0:e.uuid;return(0,n.Sk)("/api/organizations/".concat(t,"/sync/settings"),{queryKey:[i._V,{orgUuid:t}],enabled:!!e})},C=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:t}=(0,a.YL)(),o=null==t?void 0:t.uuid,r=(0,p.useQueryClient)();return(0,n.Qv)("/api/organizations/".concat(o,"/sync/settings"),"PUT",(e,t)=>{let{type:o,enabled:r}=e;t||(t=[]);let n=t.map(e=>e.type===o?{...e,enabled:r}:e);return n.some(e=>e.type===o)?n:[...t,{type:o,enabled:r}]},{queryKey:[i._V,{orgUuid:o}],enabled:!!t,onSuccess:async function(){for(var t,n=arguments.length,a=Array(n),s=0;s<n;s++)a[s]=arguments[s];await r.invalidateQueries({queryKey:[i._V,{orgUuid:o}]}),await (null==(t=e.onSuccess)?void 0:t.call(e,...a))},meta:{errorMessage:"There was an error changing your settings. Please try again."},...e})},R=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:t}=(0,a.YL)(),o=null==t?void 0:t.uuid,r=(0,p.useQueryClient)(),s=(0,l.fS)("kingfisher_enabled"),c=(0,l.fS)("apps_use_bananagrams"),u=(0,m.useLayer)("trials_freemium").get("free_integrations",!1);return(0,n.Qv)("/api/organizations/".concat(o,"/sync/settings/config"),"POST",(e,t)=>{let{type:o,config:r}=e;return t||(t=[]),t.map(e=>e.type===o?{...e,config:{...e.config,...r}}:e)},{queryKey:[i._V,{orgUuid:o}],enabled:!!(t&&(s||u)&&c),onSuccess:async function(){for(var t,n=arguments.length,a=Array(n),s=0;s<n;s++)a[s]=arguments[s];await r.invalidateQueries({queryKey:[i._V,{orgUuid:o}]}),await (null==(t=e.onSuccess)?void 0:t.call(e,...a))},meta:{errorMessage:"There was an error changing your settings. Please try again."},...e})},w=e=>{let{callerIdentifier:t,successParam:o,handleOpen:r}=e,n=(0,f.useSearchParams)(),a=(0,g.useRef)(!1);(0,g.useEffect)(()=>{!n.has(o)||a.current||t&&t!==n.get(o)||(a.current=!0,((e,t)=>{let o=new URLSearchParams(Array.from(t.entries()));o.delete(e);let r=o.toString()?"?".concat(o.toString()):"",n=window.location.pathname+r;window.history.replaceState({...window.history.state,as:n,url:n},"",n)})(o,n),r())},[n,t,r,o])},I=e=>{let t;return t=e.status.state,[u.I5.CREATED,u.I5.PENDING,u.I5.UPDATING].includes(t)},T=e=>[u.I5.FAILED,u.I5.UPDATE_FAILED].includes(e.status.state),L=()=>{let{addError:e}=(0,s.Y)(),t=(0,p.useQueryClient)();return(o,r)=>{(e=>{if(e instanceof c.LG)return e instanceof c.LG&&"access_denied"===e.errorCode})(o)&&(e("Please try again. You may need to reconnect with your ".concat(u.sb[r.sync_source_type]," account."),{error:o}),i.ku.forEach(e=>{t.invalidateQueries({queryKey:[e]})}),t.invalidateQueries({queryKey:[i.GC]}))}},A={[u.v8.GCAL]:"enabled_foccacia",[u.v8.GMAIL]:"enabled_sourdough"},P=e=>{let t=(0,a.mV)(),{data:o}=x(),r=!!(Array.isArray(o)&&o.find(t=>t.type===e&&t.enabled));return!t||r},D={"https://mcp-server-gcal-586545259222.us-central1.run.app/sse":u.v8.GCAL,"https://mcp-server-gcal-586545259222.us-central1.run.app/mcp":u.v8.GCAL,"https://gcal.mcp.claude.com/mcp":u.v8.GCAL,"https://gcal.mcp.staging.ant.dev/mcp":u.v8.GCAL,"https://mcp-server-gmail-110131437935.us-central1.run.app/sse":u.v8.GMAIL,"https://mcp-server-gmail-110131437935.us-central1.run.app/mcp":u.v8.GMAIL,"https://gmail.mcp.claude.com/mcp":u.v8.GMAIL,"https://gmail.mcp.staging.ant.dev/mcp":u.v8.GMAIL,"https://api.anthropic.com/mcp/gdrive/sse":u.v8.GDRIVE,"https://api.anthropic.com/mcp/gdrive/mcp":u.v8.GDRIVE,"https://api-staging.anthropic.com/mcp/gdrive/sse":u.v8.GDRIVE,"https://api-staging.anthropic.com/mcp/gdrive/mcp":u.v8.GDRIVE},E=e=>{let t;return t=(0,S.Uz)({type:"remote"}),t.find(t=>t.url&&D[t.url]===e)},G=e=>!!E(e),j=()=>(0,l.fS)("enabled_brioche"),k=()=>(0,l.fS)("mcp_gdrive"),O=e=>{let t=j(),o=k(),r=P(e),n=(e=>{let t="cinnabon_enabled";switch(e){case u.v8.GCAL:case u.v8.GMAIL:t="pumpernickel_enabled";break;case u.v8.GDRIVE:t="kingfisher_enabled";break;default:t="cinnabon_enabled"}let o=(0,l.fS)(t),r=(0,m.useLayer)("trials_freemium").get("free_integrations",!1),n=o||(e===u.v8.GCAL||e===u.v8.GMAIL||e===u.v8.GDRIVE)&&r;return!b.env.NEXT_PUBLIC_DISABLE_INTEGRATIONS&&n})(e),a=G(e),s=e===u.v8.GDRIVE?o:t;return!!(n&&(r||s&&a))},M=e=>"sfdc"===e?"salesforce":"gdrive"===e?"mcp/drive":e,U=e=>{let t=E(e);return t?{isFetched:!0,isAuthenticated:!!t.isConnected,server_uuid:t.uuid}:{isFetched:!1,isAuthenticated:!1,server_uuid:void 0}},z=function(e){let{callerIdentifier:t,handleAuthSuccess:o,pathname:r,queryString:c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=k(),l=j(),m=e===u.v8.GDRIVE?i:l,S=((e,t)=>{let{pathname:o,queryString:r,callerIdentifier:n}=t,a=E(e),s=O(e),c=U(e),i=n?"".concat(e,"_success=").concat(n).concat(r?"&".concat(r):""):r,l=(0,y.Q)({pathname:o,queryString:i});return{isAuthenticated:!!s&&!!a&&c.isAuthenticated,startAuth:()=>{s&&a&&l({uuid:a.uuid,url:a.url})},disconnect:()=>{},isFetched:!!a&&c.isFetched}})(e,{pathname:r,queryString:c,callerIdentifier:t}),{activeOrganization:b}=(0,a.YL)(),_=null==b?void 0:b.uuid,x=(0,f.usePathname)(),C=(0,f.useSearchParams)(),{addSuccess:R}=(0,s.Y)(),I=(0,v.A)(),T=O(e),L=(0,p.useQueryClient)(),A=(0,d.V)(),{data:P,isFetched:D}=(0,n.Sk)("/api/organizations/".concat(_,"/sync/").concat(M(e),"/auth"),{queryKey:["sync_".concat(e,"_auth_status"),{orgUuid:_}],enabled:!!(b&&T)}),G=(0,g.useRef)(!1),{mutate:z}=(0,n.L2)("/api/organizations/".concat(_,"/sync/").concat(M(e),"/auth/start"),"POST",{enabled:!!(b&&T)&&!m,onSuccess:e=>{window.location.href=e.redirect_url}});w({callerIdentifier:t,successParam:"".concat(e,"_success"),handleOpen:()=>{R(I.formatMessage({defaultMessage:"Connected to {integrationName}",id:"g0plFfAZAH"},{integrationName:u.sb[e]})),null==o||o(!0)}});let{mutate:K}=(0,n.L2)("/api/organizations/".concat(_,"/sync/").concat(M(e),"/auth"),"DELETE",{enabled:!!(b&&T)&&!m,onSuccess:()=>{L.invalidateQueries({queryKey:["sync_".concat(e,"_auth_status"),{orgUuid:_}]})}});return m&&S.isFetched?{...S,authBreakdown:{mcp:T&&S.isAuthenticated,firstParty:T&&!!(null==P?void 0:P.is_authenticated)},mcpServerGated:m}:{isAuthenticated:T&&!!(null==P?void 0:P.is_authenticated),startAuth:()=>{if(!G.current&&T){let o="".concat(e,"_success=").concat(t).concat(c?"&".concat(c):""),n=(0,h.d)({pathname:r||x,searchParams:C,queryString:o,shouldOpenInClaudeApp:A});if(A){window.location.href="/settings/connectors?open_in_browser=1&auth_start=".concat(e,"&origin=").concat(n);return}G.current=!0,z({pre_auth_state:{origin:n},redirect_uri:new URL("/connect/".concat(M(e),"/callback"),window.location.origin).toString()})}},disconnect:K,isFetched:D,authBreakdown:{mcp:T&&S.isAuthenticated,firstParty:T&&!!(null==P?void 0:P.is_authenticated)},mcpServerGated:m}},K=(e,t)=>{var o,r;let n=j(),s=k(),c=e===u.v8.GDRIVE?s:n,i=O(e),{account:l}=(0,a.YL)(),d=A[e];return!d||c?i:i&&(t?!!(null==t||null==(o=t.conversationSettings)?void 0:o[d]):!!(null==l||null==(r=l.settings)?void 0:r[d]))},N=()=>{let{account:e}=(0,a.YL)(),{mutate:t}=(0,r.yJ)();return{toggleIntegrationEnabled:(o,r)=>{if(!e)return;let n=A[o];n&&t({[n]:r})}}}},0x1c9feff0c:(e,t,o)=>{o.d(t,{B:()=>s,C:()=>c});var r=o(0x22102fd88),n=o(0xf8bd7957);let a=e=>{let{icon:t,name:o,path:a,size:s=60,imageSize:i=.5*s,...l}=e,u=t?c(t,a):"";return(0,r.jsx)(n.z,{size:s,imageSize:i,type:"external",src:u,name:o,...l})},s=e=>{var t;let{extension:o,...n}=e;return(0,r.jsx)(a,{icon:o.manifest.icon,name:null!=(t=o.manifest.display_name)?t:o.manifest.name,path:o.path,...n})};function c(e,t){if(!e)return"";if(e.startsWith("data:"))return e;if(e.startsWith("https://"))return e.replace("https://","".concat("claude-image","://"));if(e.includes("://")||!t)return"";let o=t.replace(/\\/g,"/"),r=e.replace(/\\/g,"/"),n="".concat(o,"/").concat(r);return"file://".concat(n)}},0x21fe74567:(e,t,o)=>{o.d(t,{d:()=>r});let r=e=>{let{pathname:t,searchParams:o,queryString:r,shouldOpenInClaudeApp:n}=e,a="".concat(t,"?").concat(r),s=o.get("origin");if(s)a=s;else if(n){let e=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i,o=t.startsWith("/project/")&&e.test(t.slice(9)),n=t.startsWith("/chat/")&&e.test(t.slice(6)),s=t.startsWith("/code"),c=t.startsWith("/claude-code-desktop"),i=t.startsWith("/settings"),l=o||n||s||c||i||"/new"===t?t:"/new";a="claude://claude.ai".concat(l,"?").concat(r)}return a}}}]);